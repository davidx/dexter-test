# Remove this duplicate implementation and keep only the more comprehensive one below